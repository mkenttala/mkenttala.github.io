<html>
    <body>
        <h2>ServiceWorker Test</h2>
        <p id="p1"></p>
        <script>
            function log(txt) {
                document.getElementById("p1").innerHTML += txt + "<br>";
            }

            navigator.serviceWorker.onmessage = function(event) {
                log("navigator.serviceWorker.onmessage: " + event.data);
            };

            navigator.serviceWorker.register('serviceworker.js').then(function(sw) {
                log("navigator.serviceWorker.register: " + sw);
                navigator.serviceWorker.ready.then(function(reg) {
                    log("navigator.serviceWorker.ready");
                    log("ping...");
                    reg.active.postMessage({text: "ping"});
                });
            });

    </script>
  </body>
</html>
